<!DOCTYPE html>
<html lang=zh-CN>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:description" content="Tadow çš„åšå®¢">
    <meta property="og:type" content="website">
    <meta name="description" content="Tadow çš„åšå®¢">
    <meta name="keyword"  content="Tadow, Resolmi, imlgw, åŠå²›é“ç›’, ç®—æ³•, Java, Golang">
    <link rel="shortcut icon" href="https://fav.farm/ğŸ’­">

    <title>
        
        JMeter å‹æµ‹ - Tadow ç¢ç¢å¿µ
        
    </title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/aircloud.css">

    
<link rel="stylesheet" href="/css/gitment.css">

    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_28hi1hpxx24.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
<meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Tadow ç¢ç¢å¿µ" type="application/atom+xml">
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> Keep It Simple, Stupid </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar radius">
            <img src="https://static.imlgw.top/blog/20220821160037.png" />
        </div>
        <div class="name">
            <i>Tadow</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>ä¸»é¡µ</span>
                </a>
            </li>
            <!-- <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>æ ‡ç­¾</span>
                </a>
            </li> -->
            <li >
                <a href="/categories">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>å­˜æ¡£</span>
                </a>
            </li>
            
            <li >
                <a href="/selfhosted">
                    <i class="iconfont icon-guidang1"></i>
                    <span>è‡ªå»º</span>
                </a>
            </li>

            <li >
                <a href="/collect/">
                    <i class="iconfont icon-shoucang1"></i>
                    <span>æ”¶è—</span>
                </a>
            </li>

            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>å…³äº</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>æœç´¢</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JMeter-%E5%85%A5%E9%97%A8"><span class="toc-text">JMeter å…¥é—¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E4%B8%8A%E6%89%8B"><span class="toc-text">ç®€å•ä¸Šæ‰‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%82%E6%95%B0"><span class="toc-text">æ·»åŠ è‡ªå®šä¹‰å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90-token"><span class="toc-text">ç”Ÿæˆ token</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redis-%E5%8E%8B%E6%B5%8B"><span class="toc-text">Redis å‹æµ‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%8E%8B%E6%B5%8B%E7%8E%AF%E5%A2%83"><span class="toc-text">æ­å»ºå‹æµ‹ç¯å¢ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8E%8B%E6%B5%8B"><span class="toc-text">å‘½ä»¤è¡Œå‹æµ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-text">ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot-%E6%89%93-war-%E5%8C%85"><span class="toc-text">SpringBoot æ‰“ war åŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot-%E6%89%93-jar-%E5%8C%85"><span class="toc-text">SpringBoot æ‰“ jar åŒ…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E5%8E%8B%E6%B5%8B"><span class="toc-text">å¼€å§‹å‹æµ‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E6%B5%8B%E5%95%86%E5%93%81%E5%88%97%E8%A1%A8%E9%A1%B5%E9%9D%A2"><span class="toc-text">å‹æµ‹å•†å“åˆ—è¡¨é¡µé¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">é‡åˆ°çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E9%85%8D%E7%BD%AE"><span class="toc-text">æœ€ç»ˆé…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C"><span class="toc-text">ç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E6%B5%8B-Redis-%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%80%A7%E8%83%BD"><span class="toc-text">å‹æµ‹ Redis æŸ¥è¯¢çš„æ€§èƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C-1"><span class="toc-text">ç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%B4%E6%88%8F%E2%80%94%E5%8E%8B%E6%B5%8B-do-spike-%E6%8E%A5%E5%8F%A3"><span class="toc-text">é‡å¤´æˆâ€”å‹æµ‹ do_spike æ¥å£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B6%85%E5%8D%96%E9%97%AE%E9%A2%98"><span class="toc-text">è¶…å–é—®é¢˜</span></a></li></ol></li></ol></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-bg" id="search-bg"></div>
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">æœç´¢</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> Keep It Simple, Stupid </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        JMeter å‹æµ‹
    </div>

    <div class="post-meta">
        <span class="attr">å‘å¸ƒäºï¼š<span>2019-06-06 00:00:00</span></span>
        
        <span class="attr">æ ‡ç­¾ï¼š/
        
        <a class="tag" href="/tags/#JMeter" title="JMeter">JMeter</a>
        <span>/</span>
        
        <a class="tag" href="/tags/#ç§’æ€" title="ç§’æ€">ç§’æ€</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">è®¿é—®ï¼š<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content no-indent">
        <h2 id="JMeter-å…¥é—¨"><a href="#JMeter-å…¥é—¨" class="headerlink" title="JMeter å…¥é—¨"></a>JMeter å…¥é—¨</h2><p><a target="_blank" rel="noopener" href="http://jmeter.apache.org/">å®˜ç½‘åœ°å€</a> ä¸‹è½½å¥½ä¹‹åç›´æ¥è¿è¡Œ jar åŒ… </p>
<h3 id="ç®€å•ä¸Šæ‰‹"><a href="#ç®€å•ä¸Šæ‰‹" class="headerlink" title="ç®€å•ä¸Šæ‰‹"></a>ç®€å•ä¸Šæ‰‹</h3><p><strong>æ·»åŠ çº¿ç¨‹ç»„</strong></p>
<p><img src="http://static.imlgw.top/image/20190529/wBWwVD5chqtc.png?imageslim" alt="mark"></p>
<p><strong>è®¾ç½®çº¿ç¨‹ä¸ªæ•°å’Œé…ç½®</strong></p>
<p><img src="http://static.imlgw.top/image/20190529/KonWE6pHVdMz.png?imageslim" alt="mark"></p>
<p>Ramp-Up å°±æ˜¯å¤šé•¿æ—¶é—´å†…å¯åŠ¨è¿™äº›çº¿ç¨‹è®¾ç½®ä½ 0 å°±æ˜¯åŒæ—¶å¯åŠ¨ã€‚</p>
<p><strong>è®¾ç½® HTTP è¯·æ±‚é»˜è®¤å€¼</strong></p>
<p><img src="http://static.imlgw.top/image/20190529/73A4su1jMAWM.png?imageslim" alt="mark"></p>
<p>è®¾ç½®å¥½åå†æ·»åŠ å…·ä½“çš„è¯·æ±‚çš„æ—¶å€™å°±ä¸ç”¨å†å†™è¿™ä¸ªäº†</p>
<p><img src="http://static.imlgw.top/image/20190529/Uwy5zrWzFsji.png?imageslim" alt="mark"></p>
<p><strong>æ·»åŠ  HTTP è¯·æ±‚</strong></p>
<p><img src="http://static.imlgw.top/image/20190529/iVbmgkdG7D88.png?imageslim" alt="mark"></p>
<p>è¿™é‡Œå¯¹æˆ‘ä»¬çš„ç§’æ€å•†å“åˆ—è¡¨è¿›è¡Œå‹æµ‹ã€‚</p>
<p><strong>æ·»åŠ ç›‘å¬å™¨</strong></p>
<p><img src="http://static.imlgw.top/image/20190529/yVm6imNhWYKe.png?imageslim" alt="mark"></p>
<p>è¿™é‡Œæ·»åŠ æ¯”è¾ƒå¸¸ç”¨çš„èšåˆæŠ¥å‘Šå°±å¯ä»¥äº†</p>
<p><strong>ç»“æœ</strong></p>
<p><img src="http://static.imlgw.top/image/20190531/C3pwAwyh7BhG.png?imageslim" alt="mark"></p>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥éœ€è¦å…³æ³¨çš„å°±æ˜¯ååé‡è¿™ä¸ªå‚æ•°ï¼Œä¸€å¼€å§‹å¯èƒ½ä¼šä¸å¤ªå‡†å¤šæµ‹å‡ æ¬¡ã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ Linux çš„<code>top</code>å‘½ä»¤æŸ¥çœ‹å½“å‰ CPU çš„åˆ©ç”¨ç‡ã€‚</p>
<h3 id="æ·»åŠ è‡ªå®šä¹‰å‚æ•°"><a href="#æ·»åŠ è‡ªå®šä¹‰å‚æ•°" class="headerlink" title="æ·»åŠ è‡ªå®šä¹‰å‚æ•°"></a>æ·»åŠ è‡ªå®šä¹‰å‚æ•°</h3><p><img src="http://static.imlgw.top/image/20190601/VQ9adD8KBfvA.png?imageslim" alt="mark"></p>
<p><img src="http://static.imlgw.top/image/20190601/j1XB0mewqvJG.png?imageslim" alt="mark"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="number">17362363659</span>,3d3ae96d381d4376b87cb7ebf14aadb6</span><br><span class="line"><span class="number">12012341234</span>,fbb11e35f16b4a54be1315a0a1619193</span><br><span class="line"><span class="number">11012341234</span>,58d63f1d9482472f907829da2ae3b4ff</span><br><span class="line"><span class="number">10012341234</span>,09fe09587b924c49b6db64f763c1ad10</span><br></pre></td></tr></table></figure>

<p><strong>æ•ˆæœ</strong></p>
<p><img src="http://static.imlgw.top/image/20190601/5up85aDbSTWM.png?imageslim" alt="mark"></p>
<h3 id="ç”Ÿæˆ-token"><a href="#ç”Ÿæˆ-token" class="headerlink" title="ç”Ÿæˆ token"></a>ç”Ÿæˆ token</h3><p>æ–¹ä¾¿åé¢çš„å‹æµ‹ï¼Œå¯ä»¥ç›´æ¥å†™ä¸€ä¸ªå·¥å…·ç±»ç”Ÿæˆ token ä¾›åé¢çš„ redis ä½¿ç”¨</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TokenUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SpikeUserService spikeUserService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> String str=<span class="string">&quot;0123456789&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span>  <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> HttpServletResponse resp;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        FileOutputStream outputStream=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;D:\\AliyunKey\\config.txt&quot;</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">20000</span>;i++)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> creatPhone();</span><br><span class="line">            <span class="type">RegisterVo</span> <span class="variable">registerVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RegisterVo</span>(phone,<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;user-&quot;</span>+i);</span><br><span class="line">            spikeUserService.register(registerVo);</span><br><span class="line">            <span class="comment">//éœ€è¦åœ¨ service å±‚ token è¿”å›å‡ºæ¥</span></span><br><span class="line">            String token= spikeUserService.login(resp, <span class="keyword">new</span> <span class="title class_">LoginVo</span>(registerVo.getMobile(), registerVo.getPassword()));</span><br><span class="line">            outputStream.write((phone+<span class="string">&quot;,&quot;</span>+token+<span class="string">&quot;\n&quot;</span>).getBytes());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>  String <span class="title function_">creatPhone</span><span class="params">()</span>&#123;</span><br><span class="line">        String res=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            res+=str.charAt(random.nextInt(<span class="number">10</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Redis-å‹æµ‹"><a href="#Redis-å‹æµ‹" class="headerlink" title="Redis å‹æµ‹"></a>Redis å‹æµ‹</h3><p>â‘ redis-benchmark -h 127.0.0.1 -p 6379 -c 100 -n 100000</p>
<p>100 ä¸ªå¹¶å‘ï¼Œåä¸‡ä¸ªè¯·æ±‚ï¼Œå¯¹å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤è¿›è¡Œæµ‹è¯•</p>
<p><img src="http://static.imlgw.top/image/20190601/oPkioXCFgL8R.png?imageslim" alt="mark"></p>
<p>â‘¡redis-benchmark -h 127.0.0.1 -p 6379 -q -d 100</p>
<p>100 bytes payload </p>
<p>-q æ˜¯ quiet è¾“å‡ºä¿¡æ¯è¾ƒå°‘</p>
<p>â‘¢ redis-benchmark -n 100000 -q script load â€œredis.call(â€˜setâ€™,â€™fooâ€™,â€™barâ€™)â€</p>
<p>å¯¹ç‰¹å®šçš„è¯­å¥å‹æµ‹</p>
<h2 id="æ­å»ºå‹æµ‹ç¯å¢ƒ"><a href="#æ­å»ºå‹æµ‹ç¯å¢ƒ" class="headerlink" title="æ­å»ºå‹æµ‹ç¯å¢ƒ"></a>æ­å»ºå‹æµ‹ç¯å¢ƒ</h2><h3 id="å‘½ä»¤è¡Œå‹æµ‹"><a href="#å‘½ä»¤è¡Œå‹æµ‹" class="headerlink" title="å‘½ä»¤è¡Œå‹æµ‹"></a>å‘½ä»¤è¡Œå‹æµ‹</h3><p>å…¶å®è¿˜æ˜¯éœ€è¦å€ŸåŠ©å›¾å½¢ç•Œé¢æ¥å½•å¥½ jmx æ–‡ä»¶ç„¶åä¸Šä¼ åˆ° Linux ä¸Šï¼Œç„¶åæ‰§è¡Œ</p>
<p>sh jmeter.sh -n -t Xxx.jmx -l result.jtl</p>
<p>ç„¶åå†ç”¨å›¾å½¢ç•Œé¢å¯¼å…¥ result.jtl å°±å¯ä»¥çœ‹åˆ°ç»“æœ</p>
<blockquote>
<p>ä¸Šé¢çš„æµ‹è¯•éƒ½æ˜¯åœ¨æˆ‘çš„å¼€å‘æœº (win) ä¸Šè¿›è¡Œçš„ï¼Œå‹æµ‹å’ŒæœåŠ¡éƒ½åœ¨æœ¬åœ°ï¼Œç»“æœå¯èƒ½å¹¶ä¸å‡†ç¡®ï¼Œè¿™é‡Œä¸ºäº†éš”ç¦»ç¯å¢ƒæˆ‘å¼€äº†äº† 2 ä¸ªè™šæ‹Ÿæœºï¼Œä¸€ä¸ªæ˜¯éƒ¨ç½²æœåŠ¡çš„æœºå™¨ï¼ˆ2G 4 æ ¸ï¼‰ï¼Œä¸€ä¸ªæ˜¯éƒ¨ç½² mysql å’Œ redis çš„æœºå™¨ï¼ˆ2G 4 æ ¸ï¼‰ï¼Œè¿™é‡Œåœ¨ Linux ä¸Šè¿è¡Œéƒ¨ç½²é¡¹ç›®æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æ‰“æˆ war åŒ…æ”¾åœ¨ tomcat ç›®å½•ä¸‹ï¼Œä¸€ç§æ˜¯æ‰“æˆ jar åŒ…ç›´æ¥è¿è¡Œã€‚</p>
</blockquote>
<h3 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>âœ” 192.168.25.123   Centos6  mysql+redis  2G4 æ ¸</p>
<p>âœ” 192.168.25.4     Centos7   SpikeServer+å‹æµ‹  2.5G 4 æ ¸</p>
<p>âœ”<del>win10 å¼€å‘æœº     Jmeter å‹æµ‹ SpikeServer</del> </p>
<p>âœ”<del>192.168.25.129 Centos7 å‹æµ‹è®¾å¤‡ 2G4 æ ¸</del></p>
<h3 id="SpringBoot-æ‰“-war-åŒ…"><a href="#SpringBoot-æ‰“-war-åŒ…" class="headerlink" title="SpringBoot æ‰“ war åŒ…"></a>SpringBoot æ‰“ war åŒ…</h3><p><strong>æ·»åŠ  tomcat ä¾èµ–ï¼ˆç¼–è¯‘æ—¶ä¾èµ–ï¼‰</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">	&lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ·»åŠ ä¸€ä¸ª maven æ’ä»¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;</span><br><span class="line">	&lt;configuration&gt;</span><br><span class="line">    	&lt;failOnMissingWebXml&gt;<span class="literal">false</span>&lt;/failOnMissingWebXml&gt;</span><br><span class="line">	&lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

<p><strong>ä¿®æ”¹ pom æ‰“åŒ…æ–¹å¼ä½ war</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>

<p><strong>boot ç±»æ·»åŠ ä¸€ä¸ªæ–¹æ³•</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpikeApplication</span> <span class="keyword">extends</span> <span class="title class_">SpringBootServletInitializer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpikeApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> builder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ‰“ war åŒ…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> SpringApplicationBuilder <span class="title function_">configure</span><span class="params">(SpringApplicationBuilder builder)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> builder.sources(SpikeApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œ<code>mvn clean package</code>å°±ä¼šåœ¨ target ç›®å½•ä¸‹ç”Ÿæˆ war åŒ…ï¼Œç„¶åå°† war åŒ…æ‹·åˆ° tomcat é‡Œé¢å°±å¯ä»¥ç›´æ¥è¿è¡Œäº†ã€‚</p>
<h3 id="SpringBoot-æ‰“-jar-åŒ…"><a href="#SpringBoot-æ‰“-jar-åŒ…" class="headerlink" title="SpringBoot æ‰“ jar åŒ…"></a>SpringBoot æ‰“ jar åŒ…</h3><p><strong>pom é‡Œçš„æ‰“åŒ…æ–¹å¼æ”¹ä¸º jarï¼ˆé»˜è®¤å°±æ˜¯ jar)</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ·»åŠ ä¸€ä¸ª maven æ’ä»¶</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;!--æ‰“ jar åŒ…çš„æ’ä»¶--&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">	&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>

<p><strong>æ‰§è¡Œ mvn clean package</strong></p>
<p>åŒä¸Šä¼šåœ¨ target ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª jar åŒ…ï¼Œjar åŒ…å†…å®¹å¤§è‡´å¦‚ä¸‹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Manifest-Version: <span class="number">1.0</span></span><br><span class="line">Implementation-Title: Spike</span><br><span class="line">Implementation-Version: <span class="number">1.0</span>-SNAPSHOT</span><br><span class="line">Built-By: priva</span><br><span class="line">Implementation-Vendor-Id: top.imlgw</span><br><span class="line">Spring-Boot-Version: <span class="number">2.1</span><span class="number">.2</span>.RELEASE</span><br><span class="line">Main-Class: org.springframework.boot.loader.JarLauncher</span><br><span class="line">Start-Class: top.imlgw.spike.SpikeApplication</span><br><span class="line">Spring-Boot-Classes: BOOT-INF/classes/</span><br><span class="line">Spring-Boot-Lib: BOOT-INF/lib/</span><br><span class="line">Created-By: Apache Maven <span class="number">3.5</span><span class="number">.3</span></span><br><span class="line">Build-Jdk: <span class="number">1.8</span><span class="number">.0_172</span></span><br><span class="line">Implementation-URL: https:<span class="comment">//projects.spring.io/spring-boot/#/spring-bo</span></span><br><span class="line"> ot-starter-parent/Spike</span><br></pre></td></tr></table></figure>

<p>å¦‚æœç¡®å°‘ä¸€äº›ä¿¡æ¯æ¯”å¦‚ Main-Class å’Œ Start-Classï¼Œè¯´æ˜ jar åŒ…æ‰“çš„æœ‰é—®é¢˜ï¼Œè¿è¡Œä¼šæŠ¥<code>æ²¡æœ‰ä¸»æ¸…å•å±æ€§</code>ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡æ³¨æ„ï¼Œæˆ‘çš„<code>plugins</code>ä¸Šå±‚è¿˜æœ‰ä¸ª<code>pluginmanagement</code>æ’ä»¶æ ¹æœ¬æ²¡åŠ è½½è¿›æ¥ï¼Œå»æ‰å°±è¡Œäº†ã€‚</p>
<h2 id="å¼€å§‹å‹æµ‹"><a href="#å¼€å§‹å‹æµ‹" class="headerlink" title="å¼€å§‹å‹æµ‹"></a>å¼€å§‹å‹æµ‹</h2><h3 id="å‹æµ‹å•†å“åˆ—è¡¨é¡µé¢"><a href="#å‹æµ‹å•†å“åˆ—è¡¨é¡µé¢" class="headerlink" title="å‹æµ‹å•†å“åˆ—è¡¨é¡µé¢"></a>å‹æµ‹å•†å“åˆ—è¡¨é¡µé¢</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/to_list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">tolist</span><span class="params">(Model model,SpikeUser spikeUser)</span> &#123;</span><br><span class="line">    List&lt;GoodsVo&gt; goodsVos = goodsService.goodsVoList();</span><br><span class="line">    model.addAttribute(<span class="string">&quot;user&quot;</span>, spikeUser);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;goodsList&quot;</span>,goodsVos);</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;goods_list&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ¥å£ä¸»è¦å°±åšäº†ä¸€ä¸ªæŸ¥è¯¢çš„ mysql çš„æ“ä½œï¼Œæ²¡æœ‰ cookie æ‰€ä»¥ä¸ä¼šå»æ“ä½œ redis</p>
<h3 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h3><p>ä¸€å¼€å§‹ç›´æ¥è®¾ç½®äº† 5000*10 çš„å¹¶å‘ï¼Œç„¶åæœåŠ¡ç«¯æŠ¥äº†   æ‰“å¼€æ–‡ä»¶è¿‡å¤šçš„é”™è¯¯</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.io.IOException: æ‰“å¼€çš„æ–‡ä»¶è¿‡å¤š</span><br><span class="line">        at sun.nio.ch.ServerSocketChannelImpl.accept0(Native Method) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">        at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:<span class="number">422</span>) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">        at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:<span class="number">250</span>) ~[na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br><span class="line">        at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:<span class="number">448</span>) ~[tomcat-embed-core-<span class="number">9.0</span><span class="number">.14</span>.jar!/:<span class="number">9.0</span><span class="number">.14</span>]</span><br><span class="line">        at org.apache.tomcat.util.net.NioEndpoint.serverSocketAccept(NioEndpoint.java:<span class="number">70</span>) ~[tomcat-embed-core-<span class="number">9.0</span><span class="number">.14</span>.jar!/:<span class="number">9.0</span><span class="number">.14</span>]</span><br><span class="line">        at org.apache.tomcat.util.net.Acceptor.run(Acceptor.java:<span class="number">95</span>) ~[tomcat-embed-core-<span class="number">9.0</span><span class="number">.14</span>.jar!/:<span class="number">9.0</span><span class="number">.14</span>]</span><br><span class="line">        at java.lang.Thread.run(Thread.java:<span class="number">748</span>) [na:<span class="number">1.8</span><span class="number">.0_171</span>]</span><br></pre></td></tr></table></figure>

<p>google åå‘ç°æ˜¯å¥æŸ„å¤ªå°‘çš„åŸå› ï¼ŒLinux é»˜è®¤æ˜¯ 1024ï¼Œè€Œæˆ‘ä»¬åŒæ—¶èµ·äº† 5000 ä¸ªçº¿ç¨‹è‡ªç„¶å°±å‡ºé—®é¢˜äº†ã€‚</p>
<p>é€šè¿‡<code>ulimit -a</code> å¯ä»¥æŸ¥çœ‹åˆ°å½“å‰çš„æœ€å¤§å¥æŸ„æ•°<code>open files</code> ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>ulimit -n 2048</code>ä¸´æ—¶çš„è®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„å€¼ï¼Œä½†æ˜¯é‡å¯åå°±ä¼šå¤±æ•ˆã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">core file <span class="title function_">size</span>          <span class="params">(blocks, -c)</span> <span class="number">0</span></span><br><span class="line">data seg <span class="title function_">size</span>           <span class="params">(kbytes, -d)</span> unlimited</span><br><span class="line">scheduling <span class="title function_">priority</span>             <span class="params">(-e)</span> <span class="number">0</span></span><br><span class="line">file <span class="title function_">size</span>               <span class="params">(blocks, -f)</span> unlimited</span><br><span class="line">pending <span class="title function_">signals</span>                 <span class="params">(-i)</span> <span class="number">14707</span></span><br><span class="line">max locked <span class="title function_">memory</span>       <span class="params">(kbytes, -l)</span> <span class="number">64</span></span><br><span class="line">max memory <span class="title function_">size</span>         <span class="params">(kbytes, -m)</span> unlimited</span><br><span class="line">open <span class="title function_">files</span>                      <span class="params">(-n)</span> <span class="number">1024</span></span><br><span class="line">pipe <span class="title function_">size</span>            <span class="params">(<span class="number">512</span> bytes, -p)</span> <span class="number">8</span></span><br><span class="line">POSIX message <span class="title function_">queues</span>     <span class="params">(bytes, -q)</span> <span class="number">819200</span></span><br><span class="line">real-time <span class="title function_">priority</span>              <span class="params">(-r)</span> <span class="number">0</span></span><br><span class="line">stack <span class="title function_">size</span>              <span class="params">(kbytes, -s)</span> <span class="number">8192</span></span><br><span class="line">cpu <span class="title function_">time</span>               <span class="params">(seconds, -t)</span> unlimited</span><br><span class="line">max user <span class="title function_">processes</span>              <span class="params">(-u)</span> <span class="number">14707</span></span><br><span class="line">virtual <span class="title function_">memory</span>          <span class="params">(kbytes, -v)</span> unlimited</span><br><span class="line">file <span class="title function_">locks</span>                      <span class="params">(-x)</span> unlimited</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ€å¥½æ˜¯ç›´æ¥ä¿®æ”¹  /etc/security/limits.conf</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">*  soft nofile  <span class="number">32768</span></span><br><span class="line">*  hard nofile <span class="number">65536</span></span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥å°†æ–‡ä»¶å¥æŸ„é™åˆ¶ç»Ÿä¸€æ”¹æˆè½¯ 32768ï¼Œç¡¬ 65536ã€‚é…ç½®æ–‡ä»¶æœ€å‰é¢çš„æ˜¯æŒ‡ domainï¼Œè®¾ç½®ä¸ºæ˜Ÿå·ä»£è¡¨å…¨å±€ï¼Œå¦å¤–ä½ ä¹Ÿå¯ä»¥é’ˆå¯¹ä¸åŒçš„ç”¨æˆ·åšå‡ºä¸åŒçš„é™åˆ¶ã€‚</p>
<p>æ³¨æ„ï¼šè¿™ä¸ªå½“ä¸­çš„ç¡¬é™åˆ¶æ˜¯å®é™…çš„é™åˆ¶ï¼Œè€Œè½¯é™åˆ¶ï¼Œæ˜¯ warnning é™åˆ¶ï¼Œåªä¼šåšå‡º warningï¼Œå…¶å® ulimit å‘½ä»¤æœ¬èº«å°±æœ‰åˆ†è½¯ç¡¬è®¾ç½®ï¼ŒåŠ -H å°±æ˜¯ç¡¬ï¼ŒåŠ -S å°±æ˜¯è½¯</p>
<p>ä¿®æ”¹åè®°å¾—é‡å¯æ‰ä¼šç”Ÿæ•ˆ <a target="_blank" rel="noopener" href="https://www.cnblogs.com/ibook360/archive/2012/05/11/2495405.html">å‚è€ƒèµ„æ–™</a> </p>
<p>ä¸€å¼€å§‹æ˜¯æ‰“ç®—ç›´æ¥ç”¨ win å¼€å‘æœºåšå‹æµ‹çš„ï¼Œä½†æ˜¯å‘ç°åœ¨è¿›ç¨‹å¼€å¤§äº†ä¹‹åè€æ˜¯è·‘ä¸å®Œï¼Œè·‘ä¸€åŠå°±åœäº†ï¼ˆå¯èƒ½æ˜¯å†…å­˜ç»™å°äº†ï¼‰ï¼Œè€Œä¸”æ•°æ®å‡ºå…¥ä¹Ÿæ¯”è¾ƒå¤§ï¼Œç„¶åæ”¹ç”¨ç§’æ€æœåŠ¡çš„é‚£æ¡æœºå™¨æ¥å‹æµ‹ï¼Œä¸€å¼€å§‹åªå¢å¤§äº†è·‘ç§’æ€æœåŠ¡çš„è™šæ‹Ÿæœºï¼Œå‘ç°è¿˜æ˜¯ä¼šæœ‰å¼‚å¸¸ï¼Œç„¶åæˆ‘æŠŠ mysql å’Œ redis çš„è™šæ‹Ÿæœºä¹Ÿè°ƒå¤§äº†å°±æ²¡æŠ¥å¼‚å¸¸äº†ï¼Œä½†æ˜¯åœ¨å‹æµ‹çš„æ—¶å€™ç§’æ€æœåŠ¡çš„è™šæ‹Ÿæœº cpu é£™åˆ°äº† <code>9.0+</code>ï¼Œ4 æ ¸çš„æœºå­ï¼Œcpu é£™åˆ°è¿™ä¹ˆé«˜å°±æœ‰ç‚¹é—®é¢˜äº†ä¸€èˆ¬æ¥è¯´åº”è¯¥ç»´æŒåœ¨ <code>4*0.7</code> å·¦å³ã€‚</p>
<p><img src="http://static.imlgw.top/image/20190604/LedMcRvfSXeb.png?imageslim" alt="mark"></p>
<p><img src="http://static.imlgw.top/image/20190604/UbcTCaTGiEJ9.png?imageslim" alt="mark"></p>
<p>å¯ä»¥çœ‹åˆ°å¹³å‡ç­‰å¾…æ—¶é—´éƒ½åœ¨ 2s ä»¥ä¸Šã€‚</p>
<p>ä¸ºäº†æ›´å‡†ç¡®çš„æ¨¡æ‹Ÿï¼Œæˆ‘åˆå¼€äº†ä¸€å°<del>1G2 æ ¸</del> 2G4 æ ¸çš„è™šæ‹Ÿæœºä¸“é—¨æ¥åšå‹æµ‹ï¼ˆ8G å†…å­˜åƒä¸æ¶ˆäº†ï¼‰ã€‚</p>
<p><img src="http://static.imlgw.top/image/20190604/pr4yMAE2Jamf.png?imageslim" alt="mark"></p>
<p>è¿™é‡Œç”¨ top è§‚å¯Ÿäº†ä¸¤å°è™šæ‹Ÿæœºçš„æƒ…å†µå‘ç° mysql çš„é‚£å°æœºå™¨è´Ÿè½½ä¸€ç›´å¾ˆä½ï¼ŒSpikeServer é‚£å°æœºå™¨ï¼ˆ1G åŒæ ¸ï¼‰è´Ÿè½½ä¸€è·¯é£™åˆ° 6.0+ã€‚ååç‡ä¹Ÿæ˜æ˜¾çš„ä¸‹é™äº†ï¼Œè¿™é‡Œæˆ‘è¿ç»­æµ‹è¯•äº†ä¸¤æ¬¡éƒ½æ˜¯ 400 å¤šã€‚</p>
<h3 id="æœ€ç»ˆé…ç½®"><a href="#æœ€ç»ˆé…ç½®" class="headerlink" title="æœ€ç»ˆé…ç½®"></a>æœ€ç»ˆé…ç½®</h3><p>ç»è¿‡ä¸€ä¸Šåˆçš„æŠ˜è…¾ï¼Œæˆ‘å†³å®šè¿˜æ˜¯å€¼åˆ©ç”¨ä¸¤å°ä½ è™šæ‹Ÿæœºï¼Œä¸€å°è·‘ SpikeServer å’Œå‹æµ‹ï¼Œå¦å¤–ä¸€å°è·‘ mysql å’Œ redisï¼Œå†å¯åŠ¨ä¸€å°æˆæœ¬å¤ªå¤§äº†ï¼Œè¿™é‡Œä¸»è¦æ ¹æ®è¿™ä¸ªåšä¸€ä¸ªæ ‡å‡†é‡ï¼ŒåæœŸä¼˜åŒ–åæ‹¿æ¥å¯¹æ¯”</p>
<h4 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p><img src="http://static.imlgw.top/image/20190604/IEGxtWU8pujI.png?imageslim" alt="mark"></p>
<p>åé¢åœ¨è°ƒæ•´æœºå™¨æˆ–è¿ç»­æµ‹è¯•äº† 5ï¼Œ6 æ¬¡ åœ¨ 5000 çš„å¹¶å‘ä¸‹ QPS å¤§æ¦‚æ˜¯ 1000 å·¦å³çš„æ ·å­ï¼Œå°äº 1000ã€‚</p>
<h3 id="å‹æµ‹-Redis-æŸ¥è¯¢çš„æ€§èƒ½"><a href="#å‹æµ‹-Redis-æŸ¥è¯¢çš„æ€§èƒ½" class="headerlink" title="å‹æµ‹ Redis æŸ¥è¯¢çš„æ€§èƒ½"></a>å‹æµ‹ Redis æŸ¥è¯¢çš„æ€§èƒ½</h3><p>ä¸Šé¢çš„ goods_list å®é™…ä¸Šåªå¯¹ mysql è¿›è¡Œäº†ä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼Œè€Œ mysql çš„å¹¶å‘é‡å¹¶ä¸å¤§ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å•ç‹¬å¯¹ redis åšä¸€ä¸‹å‹æµ‹ï¼Œçœ‹ä¸‹ç³»ç»Ÿçš„ QPSï¼ˆè¿™é‡Œï¼‰</p>
<p><img src="http://static.imlgw.top/image/20190604/h2NOJszwC7Lo.png?imageslim" alt="mark"></p>
<h4 id="ç»“æœ-1"><a href="#ç»“æœ-1" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p>ä¸€å¼€æµ‹è¯•å¿˜äº†è°ƒå¤§ redis é“¾æ¥æ± çš„å¤§å°ï¼Œä¸€ç›´è·‘ä¸å‡ºæ¥ï¼Œåæ¥æ”¹å¤§ä¹‹åæµ‹äº† 4ï¼Œ5 æ¬¡ï¼ŒåŒæ ·çš„ 5000 å¹¶å‘ 10 æ¬¡ï¼ŒQPS å¤§æ¦‚åœ¨ 3000 å·¦å³</p>
<p><img src="http://static.imlgw.top/image/20190606/58L5ieKaxR7a.png?imageslim" alt="mark"></p>
<p>å¯ä»¥è¯´æ˜¯ç›¸å½“å¿«äº†ï¼Œè€Œä¸”<code>top</code>è§‚å¯Ÿ redis é‚£å°æœºå™¨å‘ç°è´Ÿè½½ä¾ç„¶å¾ˆä½ï¼Œè¯´æ˜è¿™ç‚¹å¹¶å‘ç¡®å®å¯¹ redis æ¥è¯´æ˜¯å°æ„æ€ï¼Œå‰é¢å…¶å®ä¹Ÿå•ç‹¬å¯¹ redis ç”¨å®ƒè‡ªå¸¦çš„å‹æµ‹å·¥å…·æµ‹è¯•è¿‡ï¼Œå¤§æ¦‚æ¯ç§’ 10 0000 çš„ GET æ˜¯æ²¡é—®é¢˜çš„</p>
<h3 id="é‡å¤´æˆâ€”å‹æµ‹-do-spike-æ¥å£"><a href="#é‡å¤´æˆâ€”å‹æµ‹-do-spike-æ¥å£" class="headerlink" title="é‡å¤´æˆâ€”å‹æµ‹ do_spike æ¥å£"></a>é‡å¤´æˆâ€”å‹æµ‹ do_spike æ¥å£</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/do_spike&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">do_spike</span><span class="params">(Model model, SpikeUser spikeUser, <span class="meta">@RequestParam(&quot;goodsId&quot;)</span> <span class="type">long</span> goodsId)</span> &#123;</span><br><span class="line">       <span class="keyword">if</span> (spikeUser==<span class="literal">null</span>) &#123; <span class="comment">//æ²¡æœ‰ç™»å½•</span></span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//æ£€æŸ¥åº“å­˜</span></span><br><span class="line">       GoodsVo goodsVo= goodsService.getGoodsVoByGoodsId(goodsId);</span><br><span class="line">       <span class="type">int</span> stock=goodsVo.getStockCount(); <span class="comment">//è¿™é‡Œæ‹¿çš„ç§’æ€å•†å“é‡Œé¢çš„åº“å­˜ï¼Œä¸æ˜¯å•†å“é‡Œé¢çš„åº“å­˜</span></span><br><span class="line">       <span class="keyword">if</span>(stock&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">           model.addAttribute(<span class="string">&quot;failMsg&quot;</span>,CodeMsg.STOCK_EMPTY);</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;spike_fail&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="comment">//çœ‹æ˜¯å¦é‡å¤ç§’æ€</span></span><br><span class="line">       SpikeOrder spikeOrder=spikeService.getGoodsVoByUserIdAndGoodsId(spikeUser.getId(), goodsId);</span><br><span class="line">       <span class="keyword">if</span>(spikeOrder!=<span class="literal">null</span>)&#123;</span><br><span class="line">           model.addAttribute(<span class="string">&quot;failMsg&quot;</span>,CodeMsg.SKIPE_REPEAT);</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;spike_fail&quot;</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       OrderInfo orderInfo=spikeService.doSpike(spikeUser.getId(),goodsVo);</span><br><span class="line">       model.addAttribute(<span class="string">&quot;orderInfo&quot;</span>,orderInfo);</span><br><span class="line">       model.addAttribute(<span class="string">&quot;goods&quot;</span>,goodsVo);</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;order_detail&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¥éª¤éƒ½è·Ÿä¸Šé¢ä¸€æ ·ï¼Œä¸è¿‡è¦å¤šåŠ ä¸€ä¸ªå•†å“ id çš„å‚æ•°ï¼Œè¿™é‡Œä¾ç„¶æ˜¯ 5000 çš„å¹¶å‘ 10 æ¬¡ï¼Œå…¶å®è¿™é‡Œæµ‹å‡ºæ¥çš„ç»“æœå’Œä¸Šé¢çš„å•†å“åˆ—è¡¨å·®ä¸å¤ªå¤šï¼Œå·®ä¸å¤š 950 å·¦å³ QPSï¼Œæ¯•ç«Ÿè¿™é‡Œæœ‰åˆ¤æ–­åº“å­˜çš„æ“ä½œï¼Œä¸€æ—¦å°äº 0 ä¹‹åå°±ä¸ä¼šå¯¹ mysql å†è¿›è¡Œæ“ä½œï¼Œè¿›è¡Œå¤æ‚çš„<strong>å‡åº“å­˜</strong>å’Œ<strong>ç”Ÿæˆè®¢å•</strong>æ“ä½œ</p>
<h4 id="è¶…å–é—®é¢˜"><a href="#è¶…å–é—®é¢˜" class="headerlink" title="è¶…å–é—®é¢˜"></a>è¶…å–é—®é¢˜</h4><p>æœ¬æ¥åªæœ‰ 10 ä»¶å•†å“ï¼Œç¡¬ç”Ÿç”Ÿç»™å‡æˆäº†è´Ÿæ•°ğŸ˜‚</p>
<p><img src="http://static.imlgw.top/image/20190606/m5RhIzmdXRV1.png?imageslim" alt="mark"></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ 16 ä¸ªäººç§’æ€åˆ°äº†è¿™ä¸ªå•†å“è¿™æ˜¾ç„¶æ˜¯ä¸åˆç†çš„</p>
<p><img src="http://static.imlgw.top/image/20190606/nJmnvKvVzAHt.png?imageslim" alt="mark"></p>
<p>è¿™ä¸ªé—®é¢˜ä¼šåœ¨åé¢çš„æ–‡ç« ä¸­æå‡ºè§£å†³æ–¹æ¡ˆï¼Œè¿™ä¸€ç¯‡ä¸»è¦ç†Ÿæ‚‰ä¸‹å‹æµ‹ã€‚</p>

        
            <div class="donate-container">
    <div class="donate-button">
        <button id="donate-button">èµèµ</button>
    </div>
    <div class="donate-img-container hide" id="donate-img-container">
        <img id="donate-img" src="" data-src="">
        <p> æ„Ÿè°¢é¼“åŠ± </p>
    </div>
</div>
        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>
        <div id="lv-container"></div>
        <div class="giscus"></div>
    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        

        

        

        
        <li>
            <a target="_blank"  href="https://github.com/imlgw">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        

    </ul>
    
    <p>
        <span>/</span>
        
        <span><a href="https://imlgw.top">Tadow</a></span>
        <span>/</span>
        
        <span><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/publish/query/indexFirst.action">é„‚ICPå¤‡18011208å·</a></span>
        <span>/</span>
        
    </p>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>  Theme <a target="_blank" rel="noopener" href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




<script src="https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"https://cdn.jsdelivr.net/npm/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json"},"display":{"superSample":2,"width":160,"height":320,"position":"right","hOffset":0,"vOffset":-70},"mobile":{"show":false,"scale":0.2},"log":false});</script></body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

<script src="/js/index.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script src="https://giscus.app/client.js"
  data-repo="imlgw/imlgw.github.io"
  data-repo-id="MDEwOlJlcG9zaXRvcnkxMzMyMDY4NDg="
  data-category="Announcements"
  data-category-id="DIC_kwDOB_CTQM4CQ7v8"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="top"
  data-theme="light"
  data-lang="zh-CN"
  data-loading="lazy"
  crossorigin="anonymous"
  async>
</script>



</html>
